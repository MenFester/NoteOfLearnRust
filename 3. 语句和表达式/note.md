# 学习笔记

## 3.1 语句

* Rust程序从main函数开始执行
* 一个表达式总会产生一个值，因此它必然有类型。语句不产生值，它的类型永远是()
* 一个表达式加上分号就变成了一个语句。语句放到一个语句块中包起来，就可以被当成一个表达式使用

## 3.2 表达式

* Rust基本上就是一个表达式语言。表达式在Rust程序中占据重要位置。Rust中的表达式语法具有非常好的“一致性”，每种表达式都可以嵌入到另外一种表达式中，组成更强大的表达式。
* Rust的表达式包括：
  * 字面量表达式
  * 方法调用表达式
  * 数组表达式
  * 索引表达式
  * 单目运算符表达式
  * 双目运算符表达式
* Rust表达式又可以分为“左值”(lvalue)和“右值”(rvalue)两类。
  * 左值：这个表达式可以表达一个内存地址。因此它们可以放到赋值运算符左边使用
  * 其他的都是右值
* 运算表达式：
  * 算术运算符：+、-、*、/、%
  * 比较运算符：==、!=、<、>、<=、>=，两边必须同类型，并满足PartialEq约束。连续比较运算符必须加上括号
  * 位运算符：!、&、|、^、<<、>>
  * 逻辑运算符：&&、||、!。bool类型既支持“逻辑与”、“逻辑或”，也支持“按位与”、“按位或”。“逻辑与”、“逻辑或”具备“短路”功能。“按位与”、“按位或”在任何时候都会先执行左边的表达式，再执行右边的表达式，不会省略
  * 如果碰到复杂一点的表达式，尽量用小括号明确表达计算顺序，避免依赖语言默认的运算符优先级
* 赋值表达式：
  * 赋值表达式具有“副作用”：当它执行的时候，会把右边表达式的值“复制或者移动”(copy or move)到左边的表达式中
  * 赋值号左右两边表达式的类型必须一致，否则是编译错误
  * Rust规定，赋值表达式的类型为unit，即空的tuple()。这种设计是防止连续赋值，连续赋值设计没有带来性能提升，反而带来代码不清晰直观的麻烦
  * 组合赋值表达式：+=、-=、*=、/=、%=、&=、|=、^=、<<=、>>=
  * Rust不支持++、--，应当使用+=1或-=1替代
* 语句块表达式：
  * 在Rust中，语句块也可以是表达式的一部分
  * 语句和表达式的区分方式是后面带不带分号(;)。如果带了分号，意味着这是一条语句，它的类型是()。如果不带分号，它的类型就是表达式的类型。在函数里也可以利用这个特点写返回值

## 3.2 if-else

* if-else:
  * if-else表达式的构成方式为:以if关键字开头，后面跟上条件表达式（不用括号），后续是结果语句块，最后是可选的else块。条件表达式的类型必须是bool
  * 在if语句中，后续的结果语句块要求一定要用大括号包起来，不能省略，以便明确指出该if语句块的作用范围。这个规定是为了避免“悬空else”导致的bug
  * if-else结构还可以当表达式使用：` let x: i32 = if condition {1} else {10}; `
  * if分支和else分支的类型必须一致，否则就不能构成一个合法的表达式，会出现编译错误。 如果else分支省略掉了，那么编译器会认为else分支的类型默认为()
* loop：
  * 在Rust中，使用loop表示一个无限死循环
  * 可以使用continue和break控制执行流程。continue;语句表示本次循环内，后面的语句不再执行，直接进入下一轮循环。 break;语句表示跳出循环，不再继续。
  * break语句和continue语句还可以在多重循环中选择跳出到哪一层循环。可以在loop、while、for循环前面加上“生命周期标识符”。该标识符以单引号开头，在内部的循环中可以使用break语句选择跳出到哪一层
  * 与if结构一样，loop结构也可以作为表达式的一部分。loop内部break的后面可以跟一个表达式，这个表达式就是最终的loop表达式的值。如果一个loop永远不返回，那么它的类型就是“发散类型”
* while:
  * while关键字后跟条件判断语句，最后是结果语句块。如果条件满足，则持续循环执行结果语句块
  * while语句中也可以使用continue和break来控制循环流程
  * loop和while true语句在运行时没有什么区别，它们主要是会影响编译器内部的静态分析结果
* for循环：
  * Rust中的for循环实际上是许多其他语言中的for-each循环。Rust中没 有类似C/C++的三段式for循环语句
  * for循环的主要用处是利用迭代器对包含同样类型的多个元素的容器执行遍历，如:数组、链表、HashMap、HashSet等
  * for循环内部也可以使用continue和break控制执行流程